符号表在链接过程中起着重要作用，下面看下符号表的内容与符号表的使用。

### 符号表的内容

符号表同数据段和代码段一同存在于目标文件中，符号一般包含如下内容：

- 符号名

- 符号值

  如果是在目标文件中的变量和函数，值代表的是在段用的偏移

  如果实在可执行文件中的变量或函数，值代表虚拟地址

- 符号类型和绑定信息

  绑定信息->弱符号、局部符号、全局符号；

  符号类型->Object、Func、Section等

- 符号所在段

  Common块->未初始化的全局变量

  Undef -> 未定义符号

## 链接

多个目标文件在链接时会把给子的符号表合成一个全局符号表，如果出现重定义或者未定义就会报错。

在重定位时需要根据符号从全局符号表中找到符号的最终目标地址（最终目标地址由链接器来分配）

## 重定位

重定位表记录着重定位入口的偏移（可以找到需要重定位的指令位置）、需要重定位的符号在全局符号表中的下标。

重定位入口偏移根据是静态链接还是动态链接，它的值有所不同。如果是静态链接，其值为相对于段起始的偏移；如果是动态链接，其值为需要修正处的虚拟地址。

### 符号表决议

有了符号表，在链接过程中就可以判断每个被引用的函数或变量是否都被**唯一**的定义了，如果没有则链接不通过，就生成不了ELF文件。

### 参考

https://segmentfault.com/a/1190000016433829

### 非静态变量、非全局变量都不在符号表中？

是的，运行时在栈用管理

## c++ 符号修饰

- 返回值没有加入到修饰变量中，所以不能通过返回值不同来重载函数。
- 变量没有使用类型作为修饰参数中

## c++与动态库

动态库的导出接口强烈建议使用C接口。因为C++标准只规定了语言层面的规则，而对二进制级别没有任何规定。

## 控制导出符号

可以使用模块定义文件对导出符号名进行修改。参考"程序员的自我修养--链接、装载与库 9.17"

